trigger:
- main
- master

pool:
  name: self-hosted   # Keep your self-hosted agent

steps:
# Step 1: Checkout source code
- checkout: self
  displayName: 'Checkout Code'

# Step 2: Install PHP dependencies (if using Composer)
- task: Bash@3
  displayName: 'Install PHP Dependencies'
  inputs:
    targetType: 'inline'
    script: |
      if [ -f composer.json ]; then
        composer install --no-dev --optimize-autoloader
      fi

# Step 3: Deploy PHP App directly to Azure App Service
- task: AzureWebApp@1
  displayName: 'Deploy PHP App to Azure App Service'
  inputs:
    azureSubscription: 'azure-rm-connection'   # Your Azure service connection
    appName: 'php-mysql-app'                   # Your Azure App Service name
    package: '$(Build.SourcesDirectory)'       # Deploy directly from source folder
